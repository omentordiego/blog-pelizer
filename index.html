
<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" href="https://i.postimg.cc/BZF3Sqj1/PL.png" type="image/png" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    <!-- SEO Meta Tags -->
    <title>Blog Fala Pelizer - Educação Política e Cidadania</title>
    <meta name="description" content="Educação política com opinião, clareza e posicionamento. Conteúdo que forma cidadãos conscientes e participativos." />
    <meta name="keywords" content="política, educação política, cidadania, democracia, Brasil, análise política" />
    <meta name="author" content="Vanderlei Pelizer" />
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:site_name" content="Blog Fala Pelizer" />
    <meta property="og:title" content="Blog Fala Pelizer - Educação Política e Cidadania" />
    <meta property="og:description" content="Educação política com opinião, clareza e posicionamento. Conteúdo que forma cidadãos conscientes e participativos." />
    <meta property="og:image" content="https://i.postimg.cc/mgpyvymp/PONTO-DE-VISTA-3.png" />
    <meta property="og:url" content="https://your-domain.com" />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta property="og:image:type" content="image/jpeg" />
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:site" content="@vpelizerpereira" />
    <meta property="twitter:creator" content="@vpelizerpereira" />
    <meta property="twitter:title" content="Blog Fala Pelizer - Educação Política e Cidadania" />
    <meta property="twitter:description" content="Educação política com opinião, clareza e posicionamento. Conteúdo que forma cidadãos conscientes e participativos." />
    <meta property="twitter:image" content="https://i.postimg.cc/mgpyvymp/PONTO-DE-VISTA-3.png" />
    
    <!-- WhatsApp Meta Tags -->
    <meta property="og:image:alt" content="Blog Fala Pelizer - Educação Política e Cidadania" />
    <meta property="og:locale" content="pt_BR" />
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://your-domain.com" />
    
    <!-- Google AdSense Verification -->
    <meta name="google-adsense-account" content="ca-pub-3940256099942544">

    <!-- Preload critical resources -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    <!-- Pre-render Script for Social Media -->
    <script>
      (function() {
        // Função para extrair slug da URL
        function getSlugFromUrl() {
          const path = window.location.pathname;
          const blogMatch = path.match(/\/blog\/([^\/]+)/);
          const artigoMatch = path.match(/\/artigo\/([^\/]+)/);
          return blogMatch ? blogMatch[1] : (artigoMatch ? artigoMatch[1] : null);
        }
        
        // Função para validar se imagem existe
        function validateImage(url) {
          return new Promise((resolve) => {
            const img = new Image();
            img.onload = () => resolve(true);
            img.onerror = () => resolve(false);
            img.src = url;
            // Timeout após 3 segundos
            setTimeout(() => resolve(false), 3000);
          });
        }
        
        // Função para atualizar meta tags
        function updateMetaTags(title, description, image, url) {
          console.log('Atualizando meta tags no index.html:', { title, description, image, url });
          
          // Atualizar título
          document.title = title + ' - Blog Fala Pelizer';
          
          // Atualizar description
          const descMeta = document.querySelector('meta[name="description"]');
          if (descMeta) descMeta.content = description;
          
          // Atualizar Open Graph
          const ogTitle = document.querySelector('meta[property="og:title"]');
          if (ogTitle) ogTitle.content = title;
          
          const ogDesc = document.querySelector('meta[property="og:description"]');
          if (ogDesc) ogDesc.content = description;
          
          const ogImage = document.querySelector('meta[property="og:image"]');
          if (ogImage) ogImage.content = image;
          
          const ogUrl = document.querySelector('meta[property="og:url"]');
          if (ogUrl) ogUrl.content = url;
          
          const ogImageAlt = document.querySelector('meta[property="og:image:alt"]');
          if (ogImageAlt) ogImageAlt.content = title;
          
          // Atualizar Twitter
          const twitterTitle = document.querySelector('meta[property="twitter:title"]');
          if (twitterTitle) twitterTitle.content = title;
          
          const twitterDesc = document.querySelector('meta[property="twitter:description"]');
          if (twitterDesc) twitterDesc.content = description;
          
          const twitterImage = document.querySelector('meta[property="twitter:image"]');
          if (twitterImage) twitterImage.content = image;
          
          // Atualizar canonical
          const canonical = document.querySelector('link[rel="canonical"]');
          if (canonical) canonical.href = url;
          
          console.log('Meta tags atualizadas no index.html com sucesso');
        }
        
        // Carregar dados do artigo se for uma página de artigo
        async function loadArticleData() {
          const slug = getSlugFromUrl();
          if (!slug) return;
          
          console.log('Detectada página de artigo, slug:', slug);
          
          try {
            // Fazer requisição para buscar dados do artigo
            const response = await fetch(`https://lslobzzerneeullaizjo.supabase.co/rest/v1/articles?slug=eq.${slug}&select=*`, {
              headers: {
                'apikey': 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxzbG9ienplcm5lZXVsbGFpempvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDg0MzIzNDAsImV4cCI6MjA2NDAwODM0MH0.ASm0u9YZRF8W9TvJZ61go8_oRSN8kongx2ZjNlFKKv8',
                'Authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxzbG9ienplcm5lZXVsbGFpempvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDg0MzIzNDAsImV4cCI6MjA2NDAwODM0MH0.ASm0u9YZRF8W9TvJZ61go8_oRSN8kongx2ZjNlFKKv8'
              }
            });
            
            const data = await response.json();
            if (data && data.length > 0) {
              const article = data[0];
              console.log('Artigo carregado:', article.title);
              
              const title = article.title;
              const description = article.summary || `${article.title} - Leia este artigo completo no Blog Fala Pelizer sobre educação política e cidadania.`;
              let image = 'https://i.postimg.cc/mgpyvymp/PONTO-DE-VISTA-3.png'; // Fallback padrão
              const url = window.location.href;
              
              // Validar imagem do artigo se existir
              if (article.cover_image) {
                const isValidImage = await validateImage(article.cover_image);
                if (isValidImage) {
                  image = article.cover_image;
                  console.log('Imagem do artigo validada:', image);
                } else {
                  console.log('Imagem do artigo inválida, usando fallback');
                }
              }
              
              updateMetaTags(title, description, image, url);
            }
          } catch (error) {
            console.error('Erro ao carregar dados do artigo:', error);
          }
        }
        
        // Executar quando a página carregar
        if (document.readyState === 'loading') {
          document.addEventListener('DOMContentLoaded', loadArticleData);
        } else {
          loadArticleData();
        }
      })();
    </script>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
